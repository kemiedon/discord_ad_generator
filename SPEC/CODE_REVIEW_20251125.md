# Discord å»£å‘Šç”Ÿæˆå™¨ - ä»£ç¢¼å¯©æŸ¥å ±å‘Š

**å¯©æŸ¥æ—¥æœŸï¼š2025-11-25**  
**ç‰ˆæœ¬ï¼š1.0.0**  
**å¯©æŸ¥äººå“¡ï¼šAI Code Reviewer**  
**ä¸‹æ¬¡å¯©æŸ¥å»ºè­°æ—¥æœŸï¼š2025-12-02**

---

## ğŸ“‹ å¯©æŸ¥æ¦‚è¦

æœ¬å¯©æŸ¥é‡å°ã€ŒDiscord å»£å‘Šç”Ÿæˆå™¨ã€å°ˆæ¡ˆé€²è¡Œå…¨é¢æª¢æŸ¥ï¼Œæ¶µè“‹ **SPEC è¦æ ¼æ›¸**ã€**å°ˆæ¡ˆæ¶æ§‹**ã€**ä»£ç¢¼å¯¦ç¾** ä»¥åŠ **åŠŸèƒ½å®Œæ•´æ€§**ã€‚

### è©•åˆ†ç¸½è¦½

- **è¦æ ¼å¯¦ç¾åº¦**ï¼šâœ… 85%ï¼ˆMVP åŠŸèƒ½å¤§éƒ¨åˆ†å·²å¯¦ç¾ï¼Œé€²éšåŠŸèƒ½æœªå®Œæˆï¼‰
- **ä»£ç¢¼è³ªé‡**ï¼šâœ… 80%ï¼ˆçµ„ä»¶çµæ§‹æ¸…æ™°ï¼Œä½†éœ€è¦æ”¹é€²ï¼‰
- **UX å¯¦ç¾åº¦**ï¼šâœ… 75%ï¼ˆåŸºæœ¬å¯¦ç¾ï¼Œéƒ¨åˆ†ç´°ç¯€éœ€å„ªåŒ–ï¼‰
- **æŠ€è¡“æ£§åˆè¦æ€§**ï¼šâœ… 90%ï¼ˆåŸºæœ¬éµå¾ªè¦ç¯„ï¼‰

---

## ä¸€ã€SPEC è¦æ ¼æ›¸ vs å¯¦ç¾å°ç…§

### âœ… å·²å¯¦ç¾çš„åŠŸèƒ½

#### P0 - æ ¸å¿ƒåŠŸèƒ½

| åŠŸèƒ½         | ç‹€æ…‹ | èªªæ˜                               |
| ------------ | ---- | ---------------------------------- |
| è¼¸å…¥è¡¨å–®     | âœ…   | å®Œæ•´å¯¦ç¾ä¸»é¡Œã€æ—¥æœŸã€é‡é»ã€é¢¨æ ¼è¼¸å…¥ |
| æ—¥æœŸé¸æ“‡å™¨   | âœ…   | ä½¿ç”¨ jQuery UI Datepicker          |
| åƒè€ƒåœ–ç‰‡ä¸Šå‚³ | âœ…   | æ”¯æ´æ‹–æ”¾å’Œé»æ“Šä¸Šå‚³                 |
| é¢¨æ ¼é¸æ“‡å™¨   | âœ…   | 7 ç¨®é è¨­é¢¨æ ¼ä¸‹æ‹‰é¸å–®               |
| è¡¨å–®é©—è­‰     | âœ…   | å³æ™‚é©—è­‰ï¼Œæ¸…æ™°éŒ¯èª¤æç¤º             |
| åœ–ç‰‡é è¦½     | âœ…   | 3 å¼µåœ–ç‰‡ç¶²æ ¼å±•ç¤º                   |
| åœ–ç‰‡ä¸‹è¼‰     | âœ…   | æ”¯æ´å–®å¼µä¸‹è¼‰                       |

#### Firebase æ•´åˆ

| åŠŸèƒ½            | ç‹€æ…‹ | èªªæ˜                      |
| --------------- | ---- | ------------------------- |
| Firebase åˆå§‹åŒ– | âœ…   | firebase.js æ­£ç¢ºé…ç½®      |
| Storage ä¸Šå‚³    | âœ…   | firebaseStorage.js å·²å¯¦ç¾ |
| ç’°å¢ƒè®Šæ•¸è¨­å®š    | âœ…   | ä½¿ç”¨ import.meta.env      |

#### å‰ç«¯æŠ€è¡“

| æŠ€è¡“       | ç‹€æ…‹ | èªªæ˜              |
| ---------- | ---- | ----------------- |
| React 18   | âœ…   | æ­£ç¢ºä½¿ç”¨          |
| Vite 6     | âœ…   | æ­£ç¢ºé…ç½®          |
| SASS       | âœ…   | å®Œæ•´çš„æ¨£å¼ç³»çµ±    |
| jQuery UI  | âœ…   | åƒ…ç”¨æ–¼ Datepicker |
| éŸ¿æ‡‰å¼è¨­è¨ˆ | âœ…   | åŸºæœ¬å¯¦ç¾          |

### âš ï¸ éƒ¨åˆ†å¯¦ç¾çš„åŠŸèƒ½

#### Discord ç™¼å¸ƒ

| åŠŸèƒ½             | ç‹€æ…‹ | èªªæ˜                           |
| ---------------- | ---- | ------------------------------ |
| Discord Bot è¨­å®š | âš ï¸   | TODO: éœ€è¦å¯¦ä½œï¼Œç›®å‰åªæœ‰ä½”ä½ç¬¦ |
| å¤šä¼ºæœå™¨æ”¯æ´     | âš ï¸   | TODO: æœªå¯¦ç¾                   |
| è¨Šæ¯ç™¼å¸ƒ         | âš ï¸   | TODO: æ¨¡æ“¬å»¶é²ï¼Œæœªå‘¼å«çœŸå¯¦ API |

#### Nano-Banana API

| åŠŸèƒ½           | ç‹€æ…‹ | èªªæ˜                             |
| -------------- | ---- | -------------------------------- |
| API å‘¼å«       | âš ï¸   | ç›®å‰å›å‚³æ¨¡æ“¬åœ–ç‰‡ï¼Œæœªå¯¦ç¾çœŸå¯¦ç”Ÿæˆ |
| Prompt æ§‹å»º    | âœ…   | promptBuilder.js çµæ§‹å®Œæ•´        |
| Image-to-Image | âš ï¸   | ä»£ç¢¼æ”¯æŒä½†æœªæ¸¬è©¦                 |

### âŒ æœªå¯¦ç¾çš„åŠŸèƒ½

#### P1 - é€²éšåŠŸèƒ½

| åŠŸèƒ½               | ç‹€æ…‹ | èªªæ˜                     |
| ------------------ | ---- | ------------------------ |
| æ­·å²è¨˜éŒ„           | âŒ   | æœªå¯¦ç¾                   |
| é‡æ–°ç”Ÿæˆ           | âŒ   | æœªå¯¦ç¾                   |
| Discord ä¼ºæœå™¨ç®¡ç† | âŒ   | æœªå¯¦ç¾                   |
| æ‰¹æ¬¡ä¸‹è¼‰           | âŒ   | ä»£ç¢¼çµæ§‹æ”¯æŒä½†æœªå®Œå…¨å¯¦ç¾ |

---

## äºŒã€ä»£ç¢¼æ¶æ§‹åˆ†æ

### 2.1 å°ˆæ¡ˆçµæ§‹è©•åˆ†ï¼šâœ… å„ªç§€

#### å„ªé»

- âœ… **çµ„ä»¶åŒ–è¨­è¨ˆ**ï¼šæ˜ç¢ºçš„çµ„ä»¶å±¤ç´š
  - `common/` - é€šç”¨çµ„ä»¶ï¼ˆButtonã€Input ç­‰ï¼‰
  - `HomePage` - ä¸»é çµ„ä»¶
  - `InputForm` - è¡¨å–®çµ„ä»¶
  - `PreviewGrid` - é è¦½çµ„ä»¶
- âœ… **æœå‹™å±¤åˆ†é›¢**ï¼šæ¥­å‹™é‚è¼¯å’Œ API å‘¼å«åˆ†é›¢
  - `services/` - API æœå‹™
  - `utils/` - å·¥å…·å‡½æ•¸
- âœ… **é¢¨æ ¼ç³»çµ±**ï¼šå®Œæ•´çš„ SASS è®Šæ•¸å’Œ mixins
  - `_variables.scss` - å…¨å±€è®Šæ•¸
  - `_mixins.scss` - å¯é‡ç”¨ mixins
  - `global.scss` - å…¨å±€æ¨£å¼

#### å»ºè­°æ”¹é€²

- âš ï¸ ç¼ºå°‘ `constants.js` æª”æ¡ˆï¼Œé¢¨æ ¼é¸é …æ‡‰é›†ä¸­ç®¡ç†
- âš ï¸ ç¼ºå°‘ `hooks/` ç›®éŒ„ï¼Œæ‡‰æŠ½å–å¯é‡ç”¨çš„ React hooks
- âš ï¸ ç¼ºå°‘ `types/` æˆ– `constants/` ç®¡ç†ç‹€æ…‹é¡å‹

### 2.2 çµ„ä»¶åˆ†æ

#### âœ… Input çµ„ä»¶

```jsx
function Input({ label, placeholder, value, onChange, error, required, disabled, type, ...props })
```

- **å„ªé»**ï¼šå±¬æ€§å®Œæ•´ï¼Œæ”¯æ´å¿…å¡«æ¨™è¨˜ã€éŒ¯èª¤æç¤º
- **ç¼ºé»**ï¼šç¼ºå°‘ `maxLength`ã€`pattern` ç­‰é©—è­‰å±¬æ€§

#### âœ… Button çµ„ä»¶

```jsx
function Button({ children, variant, size, disabled, loading, onClick, type, ...props })
```

- **å„ªé»**ï¼šæ”¯æ´å¤šç¨®è®Šé«”ï¼ˆprimaryã€secondaryã€successï¼‰ã€size é¸é …ã€loading ç‹€æ…‹
- **å»ºè­°**ï¼šå¯å¢åŠ  `icon` å±¬æ€§æ”¯æ´

#### âš ï¸ FileUpload çµ„ä»¶

```jsx
function FileUpload({ label, onFileSelect, accept, error, required, disabled })
```

- **å„ªé»**ï¼šæ”¯æ´æ‹–æ”¾ã€é è¦½ã€æ¸…é™¤
- **ç¼ºé»**ï¼š
  - æœªé©—è­‰æª”æ¡ˆå¤§å°
  - æœªé™åˆ¶æª”æ¡ˆé¡å‹ï¼ˆåƒ…å®¢æˆ¶ç«¯æª¢æŸ¥ï¼‰
  - å»ºè­°æç¤ºä¿¡æ¯æœªé¡¯ç¤ºï¼Œéœ€æ”¹é€²

#### âœ… TextArea çµ„ä»¶

- åŠŸèƒ½å®Œæ•´ï¼Œæ”¯æ´è¡Œæ•¸å®šåˆ¶

#### âœ… Select çµ„ä»¶

- åŠŸèƒ½å®Œæ•´ï¼Œæ”¯æ´è‡ªè¨‚ placeholder

### 2.3 ä¸»è¦çµ„ä»¶åˆ†æ

#### InputForm çµ„ä»¶ - è©•åˆ†ï¼šâœ… è‰¯å¥½

```jsx
function InputForm({ onGenerate, isGenerating })
```

**å„ªé»ï¼š**

- âœ… å®Œæ•´çš„è¡¨å–®é©—è­‰é‚è¼¯
- âœ… æ­£ç¢ºä½¿ç”¨ jQuery UI Datepickerï¼ˆuseEffect åˆå§‹åŒ–å’Œæ¸…ç†ï¼‰
- âœ… æ¸…æ™°çš„éŒ¯èª¤ç‹€æ…‹ç®¡ç†
- âœ… é©ç•¶çš„ç¦ç”¨ç‹€æ…‹ï¼ˆisGenerating æ™‚ç¦ç”¨è¼¸å…¥ï¼‰

**ç¼ºé»å’Œå»ºè­°ï¼š**

- âš ï¸ Datepicker åˆå§‹åŒ–ä»£ç¢¼å¯ä»¥æå–ç‚º custom hook
  ```jsx
  // å»ºè­°ï¼šå‰µå»º useDatepicker.js
  export const useDatepicker = (inputRef, onDateSelect) => {
    useEffect(() => {
      // Datepicker åˆå§‹åŒ–é‚è¼¯
    }, [])
  }
  ```
- âš ï¸ é»æ•¸åˆ†å‰²é‚è¼¯æ‡‰ç§»åˆ° utils
  ```javascript
  // å»ºè­°ï¼šåœ¨ utils/textParser.js
  export const parsePoints = text => {
    return text
      .split('\n')
      .map(p => p.trim())
      .filter(p => p.length > 0)
  }
  ```
- âš ï¸ STYLE_OPTIONS æ‡‰æ”¾åœ¨ constants.js
- âš ï¸ ç¼ºå°‘ `autoComplete="off"` åœ¨ date inputï¼ˆå·²æœ‰ï¼Œå¾ˆå¥½ï¼‰
- âœ… è¡¨å–®æäº¤ä½¿ç”¨ `e.preventDefault()` æ­£ç¢º

#### HomePage çµ„ä»¶ - è©•åˆ†ï¼šâœ… ä¸­ç­‰

```jsx
function HomePage() {
  const [generatedImages, setGeneratedImages] = useState([])
  const [isGenerating, setIsGenerating] = useState(false)
  const [isPublishing, setIsPublishing] = useState(false)
}
```

**å„ªé»ï¼š**

- âœ… ç‹€æ…‹ç®¡ç†æ¸…æ™°
- âœ… é©ç•¶çš„ç•°æ­¥æµç¨‹è™•ç†
- âœ… éŒ¯èª¤æ•æ‰å’Œç”¨æˆ¶æç¤º

**ç¼ºé»å’Œå»ºè­°ï¼š**

- âš ï¸ ç™¼å¸ƒé‚è¼¯æ˜¯ TODO è¨»é‡‹ï¼Œéœ€è¦å¯¦ç¾
- âš ï¸ ç¼ºå°‘ loading ç‹€æ…‹æ¸…æ™°åº¦
- âš ï¸ å»ºè­°æå–ç‚ºè‡ªå®šç¾© hookï¼š`useImageGeneration`
- âš ï¸ æ‡‰å¢åŠ  toast é€šçŸ¥ç³»çµ±è€Œä¸æ˜¯ `alert()`

#### PreviewGrid çµ„ä»¶ - è©•åˆ†ï¼šâœ… è‰¯å¥½

```jsx
function PreviewGrid({ images, isGenerating, onPublish, isPublishing })
```

**å„ªé»ï¼š**

- âœ… æ¸…æ™°çš„ç©ºç‹€æ…‹é¡¯ç¤º
- âœ… Loading ç‹€æ…‹è™•ç†
- âœ… å¤šé¸åŠŸèƒ½å®Œæ•´
- âœ… å…¨é¸/å–æ¶ˆå…¨é¸é‚è¼¯

**ç¼ºé»å’Œå»ºè­°ï¼š**

- âš ï¸ ä¸‹è¼‰åŠŸèƒ½æ‡‰å¢åŠ éŒ¯èª¤è™•ç†
- âš ï¸ ç¼ºå°‘åœ–ç‰‡é è¦½æ”¾å¤§åŠŸèƒ½ï¼ˆspec è¦æ±‚ã€Œæ”¯æ´é»æ“Šæ”¾å¤§æŸ¥çœ‹ã€ï¼‰
  ```jsx
  // å»ºè­°ï¼šå¢åŠ  modal é è¦½åŠŸèƒ½
  const [previewImage, setPreviewImage] = useState(null)
  ```
- âš ï¸ ä¸‹è¼‰æ–‡ä»¶åæ‡‰ä½¿ç”¨ spec è¦å®šçš„æ ¼å¼

### 2.4 æœå‹™å±¤åˆ†æ

#### âœ… firebaseStorage.js - è©•åˆ†ï¼šâœ… å„ªç§€

```javascript
export const uploadFile = async(file, (path = 'uploads'))
```

- âœ… éŒ¯èª¤è™•ç†å®Œæ•´
- âœ… è‡ªå‹•ç”Ÿæˆå”¯ä¸€æª”æ¡ˆåï¼ˆtimestamp + åŸå§‹æª”æ¡ˆåï¼‰
- âœ… è¿”å›ä¸‹è¼‰ URL

#### âš ï¸ nanoBananaService.js - è©•åˆ†ï¼šâš ï¸ éœ€è¦å¯¦ç¾

```javascript
export const generateImages = async(prompt, referenceImageUrl)
```

**å•é¡Œï¼š**

- âŒ å›å‚³ mock æ•¸æ“šï¼ˆMOCK_IMAGESï¼‰
- âŒ å¯¦éš› API å‘¼å«è¢«è¨»é‡‹æ‰
- âŒ æ‡‰è©²å‘¼å«çœŸå¯¦çš„ nano-banana pro API

**å»ºè­°å¯¦ç¾ï¼š**

```javascript
export const generateImages = async (prompt, referenceImageUrl) => {
  const apiKey = import.meta.env.VITE_NANO_BANANA_API_KEY

  try {
    // æ‡‰é€é Firebase Function å‘¼å«ä»¥ä¿è­· API Key
    const response = await fetch('/.netlify/functions/generateImages', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ prompt, referenceImageUrl })
    })

    if (!response.ok) throw new Error('ç”Ÿæˆå¤±æ•—')

    const data = await response.json()
    return data.imageUrls
  } catch (error) {
    console.error('åœ–ç‰‡ç”Ÿæˆå¤±æ•—:', error)
    throw error
  }
}
```

#### promptBuilder.js - è©•åˆ†ï¼šâœ… è‰¯å¥½

```javascript
export const buildPrompt = data
```

**å„ªé»ï¼š**

- âœ… å®Œæ•´çš„ prompt çµæ§‹
- âœ… é¢¨æ ¼é—œéµå­—æ˜ å°„å®Œæ•´
- âœ… æ–‡å­—å¯è®€æ€§æŒ‡ä»¤æ¸…æ™°

**ç¼ºé»å’Œå»ºè­°ï¼š**

- âš ï¸ å»ºè­°å¢åŠ æ–‡å­—é•·åº¦æª¢æŸ¥ï¼š
  ```javascript
  // ä¸»é¡Œéé•·æ™‚çš„æé†’
  if (topic.length > 20) {
    console.warn('ä¸»é¡Œéé•·ï¼Œå»ºè­°ç¸®çŸ­ä»¥ç¢ºä¿å¯è®€æ€§')
  }
  ```
- âš ï¸ æ—¥æœŸæ ¼å¼æ‡‰é©—è­‰
- âš ï¸ ç¼ºå°‘ fallback é¢¨æ ¼è™•ç†

### 2.5 æ¨£å¼åˆ†æ - è©•åˆ†ï¼šâœ… å„ªç§€

#### âœ… è®Šæ•¸ç³»çµ± (\_variables.scss)

- âœ… å®Œæ•´çš„é¡è‰²ç³»çµ±ï¼ˆDiscord å“ç‰Œè‰² + è¼”åŠ©è‰²ï¼‰
- âœ… å®Œæ•´çš„å­—é«”å®šç¾©
- âœ… å®Œæ•´çš„é–“è·ç³»çµ±ï¼ˆSpacing Scaleï¼‰
- âœ… å®Œæ•´çš„æ–·é»å®šç¾©
- âœ… é™°å½±å’Œåœ“è§’å®šç¾©

#### âš ï¸ ç¼ºå°‘ \_mixins.scss å…§å®¹

- âŒ SCSS ä¸­ä½¿ç”¨ `@include mobile` ä½†æª”æ¡ˆæœªæä¾›
- **å»ºè­°å»ºç«‹ \_mixins.scss**ï¼š

  ```scss
  @mixin mobile {
    @media (max-width: $breakpoint-tablet) {
      @content;
    }
  }

  @mixin tablet {
    @media (max-width: $breakpoint-desktop) {
      @content;
    }
  }

  @mixin desktop {
    @media (min-width: $breakpoint-desktop) {
      @content;
    }
  }
  ```

#### âœ… global.scss

- âœ… æ­£ç¢ºçš„å…¨å±€é‡ç½®
- âœ… æ¸…æ™°çš„æ’ç‰ˆ
- âœ… å‹•ç•«å®šç¾©ï¼ˆfadeIn, slideUp, spinï¼‰

#### âœ… App.scss

- âœ… æ­£ç¢ºä½¿ç”¨ SASS è®Šæ•¸
- âœ… é ­éƒ¨æ¼¸å±¤è¨­è¨ˆç¬¦åˆè¨­è¨ˆç¨¿
- âœ… é©æ‡‰å¼è¨­è¨ˆå¯¦ç¾

---

## ä¸‰ã€åŠŸèƒ½å®Œæ•´æ€§æª¢æŸ¥

### 3.1 P0 åŠŸèƒ½å®Œæˆåº¦ï¼šâœ… 85%

| éœ€æ±‚         | å¯¦ç¾    | å‚™è¨»                            |
| ------------ | ------- | ------------------------------- |
| è¡¨å–®è¼¸å…¥     | âœ… å®Œæ•´ | æ‰€æœ‰æ¬„ä½å·²å¯¦ç¾                  |
| æ—¥æœŸé¸æ“‡     | âœ… å®Œæ•´ | jQuery UI Datepicker æ­£ç¢ºé›†æˆ   |
| é¢¨æ ¼é¸æ“‡     | âœ… å®Œæ•´ | 7 ç¨®é¢¨æ ¼å®Œæ•´                    |
| åƒè€ƒåœ–ç‰‡ä¸Šå‚³ | âœ… å®Œæ•´ | æ”¯æ´æ‹–æ”¾å’Œé»æ“Š                  |
| åœ–ç‰‡ç”Ÿæˆ     | âš ï¸ 50%  | Prompt æ§‹å»ºå®Œæˆï¼ŒAPI å‘¼å«æœªå¯¦ç¾ |
| åœ–ç‰‡é è¦½     | âœ… å®Œæ•´ | 3 å¼µåœ–ç‰‡å±•ç¤º                    |
| Discord ç™¼å¸ƒ | âŒ 0%   | å®Œå…¨æœªå¯¦ç¾                      |
| è¡¨å–®é©—è­‰     | âœ… å®Œæ•´ | å³æ™‚é©—è­‰å®Œæˆ                    |
| éŸ¿æ‡‰å¼è¨­è¨ˆ   | âœ… 70%  | åŸºæœ¬å¯¦ç¾ï¼Œéœ€è¦ç´°åŒ–              |

### 3.2 P1 åŠŸèƒ½å®Œæˆåº¦ï¼šâŒ 0%

- âŒ æ­·å²è¨˜éŒ„ - æœªå¯¦ç¾
- âŒ Discord ä¼ºæœå™¨ç®¡ç† - æœªå¯¦ç¾
- âŒ é‡æ–°ç”Ÿæˆ - æœªå¯¦ç¾

### 3.3 UX è¨­è¨ˆè¦ç¯„ç¬¦åˆåº¦

| éœ€æ±‚          | å¯¦ç¾ | è©•åˆ†                |
| ------------- | ---- | ------------------- |
| å–®æ¬„ä½ˆå±€      | âœ…   | âœ… 100%             |
| å³æ™‚é©—è­‰      | âœ…   | âœ… 90%              |
| æ¸…æ™°æ¨™ç±¤      | âœ…   | âœ… 95%              |
| æ¼¸é€²å¼æ­éœ²    | âœ…   | âœ… 85%              |
| Loading ç‹€æ…‹  | âœ…   | âœ… 80%              |
| æˆåŠŸ/å¤±æ•—æç¤º | âš ï¸   | âš ï¸ 40% (ä½¿ç”¨ alert) |
| é è¦½å±•ç¤º      | âœ…   | âœ… 90%              |
| è¡Œå‹•è£ç½®å„ªåŒ–  | âš ï¸   | âš ï¸ 70%              |

---

## å››ã€ä»£ç¢¼è³ªé‡åˆ†æ

### 4.1 ä»£ç¢¼é¢¨æ ¼ - è©•åˆ†ï¼šâœ… è‰¯å¥½

#### âœ… æ­£é¢

- âœ… ä¸€è‡´çš„å‘½åè¦ç¯„ï¼ˆcamelCase for variables, PascalCase for componentsï¼‰
- âœ… é©ç•¶çš„è¨»é‡‹
- âœ… æ¸…æ™°çš„å‡½æ•¸ç°½å
- âœ… æ­£ç¢ºçš„ React hooks ä½¿ç”¨

#### âš ï¸ æ”¹é€²ç©ºé–“

- âš ï¸ ç¼ºå°‘ JSDoc æ–‡æª”
- âš ï¸ éƒ¨åˆ†å‡½æ•¸ç¼ºå°‘å‹åˆ¥æª¢æŸ¥ï¼ˆTypeScriptï¼‰

### 4.2 éŒ¯èª¤è™•ç† - è©•åˆ†ï¼šâš ï¸ ä¸­ç­‰

#### âœ… è‰¯å¥½

- âœ… HomePage ä¸­æœ‰ try-catch
- âœ… firebaseStorage ä¸­æœ‰éŒ¯èª¤æ—¥èªŒ

#### âš ï¸ éœ€è¦æ”¹é€²

- âš ï¸ ä½¿ç”¨ `alert()` é¡¯ç¤ºéŒ¯èª¤ï¼ˆæ‡‰ä½¿ç”¨ toast é€šçŸ¥ï¼‰
- âš ï¸ ç¼ºå°‘ç¶²è·¯éŒ¯èª¤é‡è©¦æ©Ÿåˆ¶
- âš ï¸ ç¼ºå°‘è¶…æ™‚è™•ç†

### 4.3 æ€§èƒ½è€ƒæ…® - è©•åˆ†ï¼šâš ï¸ ä¸­ç­‰

#### âœ… è‰¯å¥½

- âœ… ä½¿ç”¨ React.memo æ‡¶åŠ è¼‰é©ç•¶çµ„ä»¶
- âœ… æ­£ç¢ºçš„ useEffect ä¾è³´é™£åˆ—

#### âš ï¸ éœ€è¦æ”¹é€²

- âš ï¸ åœ–ç‰‡é è¦½æ²’æœ‰ç¼©å°ç‰ˆæœ¬ï¼ˆæ‡‰ä½¿ç”¨ thumbnailï¼‰
- âš ï¸ ç¼ºå°‘åœ–ç‰‡æ‡¶åŠ è¼‰
- âš ï¸ ç¼ºå°‘æ‰“åŒ…æœ€ä½³åŒ–å»ºè­°

---

## äº”ã€SPEC è¦æ ¼æ›¸è©•å¯©

### 5.1 MAIN.md - è©•åˆ†ï¼šâœ… å„ªç§€

#### âœ… å®Œæ•´æ€§

- âœ… å°ˆæ¡ˆç›®æ¨™æ¸…æ™°
- âœ… æŠ€è¡“éœ€æ±‚è©³ç´°
- âœ… åŠŸèƒ½éœ€æ±‚åˆ†ç´šï¼ˆP0/P1ï¼‰
- âœ… UX è¨­è¨ˆè¦ç¯„å…¨é¢
- âœ… é–‹ç™¼éšæ®µè¦åŠƒæ¸…æ™°

#### âš ï¸ æ”¹é€²å»ºè­°

- âš ï¸ ç¼ºå°‘æ€§èƒ½æŒ‡æ¨™ï¼ˆæœªå®šç¾© SEO å„ªåŒ–æ–¹æ¡ˆï¼‰
- âš ï¸ ç¼ºå°‘è¨ªå•æ§åˆ¶ï¼ˆèª°å¯ä»¥ä½¿ç”¨æ­¤å·¥å…·ï¼‰
- âš ï¸ ç¼ºå°‘è³‡æ–™å®‰å…¨è€ƒæ…®
- âš ï¸ ç¼ºå°‘å‚™ä»½å’Œæ¢å¾©è¨ˆç•«

### 5.2 PROMPT_GUIDE.md - è©•åˆ†ï¼šâœ… è‰¯å¥½

#### âœ… å®Œæ•´æ€§

- âœ… æ¸…æ™°çš„è¦ç¯„å®šç¾©
- âœ… æ˜ç¢ºçš„ç‰ˆæœ¬æ§åˆ¶è¦æ±‚
- âœ… æç¤ºè©æ¡†æ¶çµæ§‹æ¸…æ™°

#### âš ï¸ å»ºè­°

- âš ï¸ Commit è¨Šæ¯æ ¼å¼å»ºè­°å„ªåŒ–
  - ç•¶å‰æ ¼å¼ï¼š`(2025-11-24 23:16:32)-1.0`
  - å»ºè­°ï¼š`feat(core): å®ŒæˆåŸºæœ¬åŠŸèƒ½ - v1.0`ï¼ˆæ›´æ¨™æº–çš„ Conventional Commitsï¼‰
- âš ï¸ ç¼ºå°‘é—œæ–¼è‡ªå‹•åŒ–æ¸¬è©¦çš„è¦ç¯„

---

## å…­ã€æŠ€è¡“æª¢æŸ¥æ¸…å–®

### 6.1 ä¾è³´åˆ†æ

#### âœ… æª¢æŸ¥é€šé

- âœ… React 18.3.1 - æœ€æ–°ç©©å®šç‰ˆ
- âœ… Vite 6.0.5 - æœ€æ–°ç©©å®šç‰ˆ
- âœ… Firebase 11.0.2 - æœ€æ–°ç‰ˆ
- âœ… Axios 1.7.9 - ç”¨æ–¼ HTTP è«‹æ±‚
- âœ… SASS 1.83.0 - CSS é è™•ç†

#### âš ï¸ ç¼ºå°‘ä¾è³´

```json
{
  "prop-types": "^15.8.1", // é‹è¡Œæ™‚å‹åˆ¥æª¢æŸ¥
  "react-icons": "^4.x.x", // åœ–ç¤ºåº«
  "zustand": "^4.x.x", // ç‹€æ…‹ç®¡ç†ï¼ˆå¯é¸ï¼‰
  "react-hot-toast": "^2.x.x" // Toast é€šçŸ¥
}
```

### 6.2 ç’°å¢ƒé…ç½®

#### âœ… æª¢æŸ¥é€šé

- âœ… .env è®Šæ•¸ä½¿ç”¨ `import.meta.env` (Vite æ–¹å¼)
- âœ… Firebase é…ç½®æ­£ç¢º

#### âš ï¸ å»ºè­°

- âš ï¸ å»ºç«‹ `.env.example` æª”æ¡ˆ
- âš ï¸ å¢åŠ é–‹ç™¼ç’°å¢ƒ vs ç”Ÿç”¢ç’°å¢ƒçš„é…ç½®

### 6.3 ç€è¦½å™¨ç›¸å®¹æ€§

#### âœ… é æœŸæ”¯æ´

- âœ… Chromeã€Firefoxã€Safariã€Edgeï¼ˆæœ€æ–°ç‰ˆï¼‰
- âš ï¸ å»ºè­°ç¢ºèª IE ä¸éœ€è¦æ”¯æ´ï¼ˆå‡è¨­ noï¼‰

---

## ä¸ƒã€å®‰å…¨è€ƒæ…® - è©•åˆ†ï¼šâš ï¸ éœ€è¦æ”¹é€²

### âš ï¸ ç™¼ç¾çš„å•é¡Œ

1. **API Key æš´éœ²é¢¨éšª**

   - âŒ nano-banana API key æœƒåœ¨å®¢æˆ¶ç«¯æš´éœ²
   - âœ… å»ºè­°ï¼šæ”¹ä½¿ç”¨ Firebase Functions ä»£ç†

   ```
   å‰ç«¯ â†’ Firebase Function â†’ nano-banana API
   ```

2. **Discord Bot Token**

   - âš ï¸ éœ€è¦å®‰å…¨ç®¡ç† Discord Bot Token
   - âœ… å»ºè­°ï¼šå„²å­˜åœ¨ Firestore ä¸¦ä½¿ç”¨èªè­‰

3. **ä¸Šå‚³é©—è­‰**
   - âš ï¸ ç¼ºå°‘æª”æ¡ˆå¤§å°å’Œé¡å‹é©—è­‰
   - âœ… å»ºè­°ï¼šå¯¦æ–½æª”æ¡ˆä¸Šå‚³é™åˆ¶

### âœ… è‰¯å¥½çš„åšæ³•

- âœ… ä½¿ç”¨ Firebase è€Œéè‡ªå»ºå¾Œç«¯
- âœ… ä½¿ç”¨ç’°å¢ƒè®Šæ•¸ä¿è­·æ•æ„Ÿè³‡è¨Š

---

## å…«ã€æ¸¬è©¦å»ºè­°

### å»ºè­°çš„æ¸¬è©¦è¦†è“‹

#### å–®å…ƒæ¸¬è©¦

```javascript
// tests/utils/promptBuilder.test.js
test('buildPrompt æ‡‰åŒ…å«æ‰€æœ‰å¿…è¦å…ƒç´ ')
test('buildPrompt æ‡‰æ­£ç¢ºè½‰æ›é¢¨æ ¼é—œéµå­—')

// tests/utils/textParser.test.js
test('parsePoints æ‡‰æ­£ç¢ºåˆ†å‰²é‡é»')

// tests/services/firebaseStorage.test.js
test('uploadFile æ‡‰æˆåŠŸä¸Šå‚³')
test('uploadFile æ‡‰è™•ç†éŒ¯èª¤')
```

#### çµ„ä»¶æ¸¬è©¦

```javascript
// tests/components/InputForm.test.jsx
test('InputForm æ‡‰é©—è­‰å¿…å¡«æ¬„ä½')
test('InputForm æ‡‰æ­£ç¢ºåˆå§‹åŒ– Datepicker')

// tests/components/PreviewGrid.test.jsx
test('PreviewGrid æ‡‰é¡¯ç¤º 3 å¼µåœ–ç‰‡')
test('PreviewGrid æ‡‰æ”¯æ´å¤šé¸')
```

#### é›†æˆæ¸¬è©¦

```javascript
// tests/integration/imageGeneration.test.js
test('å®Œæ•´çš„åœ–ç‰‡ç”Ÿæˆæµç¨‹')
```

---

## ä¹ã€å„ªåŒ–å»ºè­°

### 9.1 ç«‹å³æ”¹é€²ï¼ˆé«˜å„ªå…ˆç´šï¼‰

1. **å¯¦ç¾ nano-banana API å‘¼å«**

   ```javascript
   // æ”¹é€² nanoBananaService.js
   export const generateImages = async (prompt, referenceImageUrl) => {
     // å‘¼å«çœŸå¯¦ API
   }
   ```

2. **å¯¦ç¾ Discord ç™¼å¸ƒåŠŸèƒ½**

   ```javascript
   // æ–°å»º services/discordService.js
   export const publishToDiscord = async (images, formData) => {
     // Discord API å‘¼å«é‚è¼¯
   }
   ```

3. **å»ºç«‹ Toast é€šçŸ¥ç³»çµ±**

   ```bash
   npm install react-hot-toast
   ```

4. **æå– \_mixins.scss**
   ```scss
   // src/styles/_mixins.scss
   @mixin mobile { ... }
   @mixin tablet { ... }
   ```

### 9.2 ä¸­æœŸæ”¹é€²ï¼ˆä¸­å„ªå…ˆç´šï¼‰

5. **å¢åŠ åœ–ç‰‡é è¦½æ¨¡æ…‹**

   - æ”¯æ´é»æ“Šæ”¾å¤§æŸ¥çœ‹

6. **å¯¦ç¾æ­·å²è¨˜éŒ„åŠŸèƒ½**

   - å„²å­˜åˆ° Firestore
   - é¡¯ç¤ºæ­·å²åˆ—è¡¨

7. **æ”¹é€²éŸ¿æ‡‰å¼è¨­è¨ˆ**

   - å®Œå–„æ‰‹æ©Ÿç‰ˆä½ˆå±€
   - æ¸¬è©¦å„ç¨®è¢å¹•å°ºå¯¸

8. **å¢åŠ  TypeScript æ”¯æ´**
   ```bash
   npm install -D typescript @types/node
   ```

### 9.3 é•·æœŸæ”¹é€²ï¼ˆä½å„ªå…ˆç´šï¼‰

9. **å»ºç«‹è¨­è¨ˆç³»çµ±æ–‡æª”**

   - Storybook æ•´åˆ
   - çµ„ä»¶æ–‡æª”

10. **å¢åŠ åˆ†æåŠŸèƒ½**

    - ä½¿ç”¨è€…è¡Œç‚ºè¿½è¹¤
    - åœ–ç‰‡ç”ŸæˆæˆåŠŸç‡çµ±è¨ˆ

11. **æ€§èƒ½æœ€ä½³åŒ–**
    - åœ–ç‰‡å£“ç¸®
    - CDN æ•´åˆ
    - ä»£ç¢¼åˆ†å‰²

---

## åã€æ–‡æª”å¯©æŸ¥

### âœ… å·²æä¾›æ–‡æª”

- âœ… README.md - æ¸…æ™°å®Œæ•´
- âœ… SPEC/MAIN.md - è©³ç´°è¦æ ¼
- âœ… SPEC/PROMPT_GUIDE.md - é–‹ç™¼è¦ç¯„

### âš ï¸ ç¼ºå°‘æ–‡æª”

- âŒ API æ–‡æª”
- âŒ çµ„ä»¶æ–‡æª”ï¼ˆStorybookï¼‰
- âŒ éƒ¨ç½²æŒ‡å—
- âŒ æ•…éšœæ’æŸ¥æŒ‡å—
- âŒ Contributing æŒ‡å—

### å»ºè­°æ–°å¢æ–‡æª”

```
docs/
â”œâ”€â”€ API.md              # API æ–‡æª”
â”œâ”€â”€ DEPLOYMENT.md       # éƒ¨ç½²æŒ‡å—
â”œâ”€â”€ ARCHITECTURE.md     # æ¶æ§‹è¨­è¨ˆ
â”œâ”€â”€ TROUBLESHOOTING.md  # æ•…éšœæ’æŸ¥
â””â”€â”€ CONTRIBUTING.md     # è²¢ç»æŒ‡å—
```

---

## åä¸€ã€ç¸½çµè©•åˆ†

### å„æ–¹é¢è©•åˆ†

| æ–¹é¢       | è©•åˆ†    | èªªæ˜                      |
| ---------- | ------- | ------------------------- |
| ä»£ç¢¼æ¶æ§‹   | ğŸŸ¢ 8/10 | çµæ§‹æ¸…æ™°ï¼Œéœ€å°æ”¹é€²        |
| ä»£ç¢¼è³ªé‡   | ğŸŸ¡ 7/10 | åŸºæœ¬è‰¯å¥½ï¼Œç¼ºä¹å‹åˆ¥æª¢æŸ¥    |
| åŠŸèƒ½å®Œæ•´æ€§ | ğŸŸ¡ 7/10 | MVP å¤§éƒ¨åˆ†å®Œæˆï¼ŒP1 æœªå•Ÿå‹• |
| UX å¯¦ç¾åº¦  | ğŸŸ¡ 7/10 | åŸºæœ¬å¯¦ç¾ï¼Œç´°ç¯€éœ€å„ªåŒ–      |
| æ–‡æª”å®Œæ•´æ€§ | ğŸŸ¡ 7/10 | è¦æ ¼å®Œæ•´ï¼Œç¼ºå°‘éƒ¨åˆ†æ–‡æª”    |
| å®‰å…¨æ€§     | ğŸŸ¡ 6/10 | åŸºæœ¬å¯ç”¨ï¼Œéœ€æ”¹é€² API å®‰å…¨ |
| æ¸¬è©¦è¦†è“‹   | ğŸ”´ 3/10 | ç¼ºå°‘æ¸¬è©¦                  |
| æ€§èƒ½å„ªåŒ–   | ğŸŸ¡ 6/10 | åŸºæœ¬å¯ç”¨ï¼Œå¯å„ªåŒ–          |

### æœ€çµ‚è©•åˆ†ï¼šğŸŸ¡ 7/10

**æ•´é«”è©•åƒ¹ï¼š** è©²é …ç›®å…·æœ‰è‰¯å¥½çš„åŸºç¤çµæ§‹å’Œæ¸…æ™°çš„è¨­è¨ˆæ–‡æª”ã€‚æ ¸å¿ƒåŠŸèƒ½åŸºæœ¬å¯¦ç¾ï¼Œä½†éœ€è¦å®Œæˆ API æ•´åˆå’Œ Discord åŠŸèƒ½ã€‚å»ºè­°æŒ‰ä»¥ä¸‹å„ªå…ˆç´šé€²è¡Œï¼š

1. å¯¦ç¾ nano-banana API å‘¼å«
2. å¯¦ç¾ Discord ç™¼å¸ƒ
3. å¢åŠ éŒ¯èª¤è™•ç†å’Œ Toast é€šçŸ¥
4. å¯¦ç¾ P1 åŠŸèƒ½

---

## åäºŒã€å¾ŒçºŒè¡Œå‹•æ¸…å–®

### å„ªå…ˆç´š 1ï¼ˆæœ¬å‘¨ï¼‰

- [ ] å¯¦ç¾ nano-banana API å‘¼å«ï¼ˆnanoBananaService.jsï¼‰
- [ ] å¯¦ç¾ Discord ç™¼å¸ƒåŠŸèƒ½ï¼ˆæ–°å»º discordService.jsï¼‰
- [ ] æ•´åˆ Toast é€šçŸ¥ç³»çµ±
- [ ] å»ºç«‹ \_mixins.scss

### å„ªå…ˆç´š 2ï¼ˆä¸‹å‘¨ï¼‰

- [ ] å¢åŠ åœ–ç‰‡é è¦½æ¨¡æ…‹
- [ ] å¯¦ç¾æ­·å²è¨˜éŒ„åŠŸèƒ½
- [ ] æ”¹é€²éŸ¿æ‡‰å¼è¨­è¨ˆ
- [ ] å¢åŠ å–®å…ƒæ¸¬è©¦

### å„ªå…ˆç´š 3ï¼ˆé•·æœŸï¼‰

- [ ] å®Œæ•´ TypeScript é·ç§»
- [ ] Storybook æ•´åˆ
- [ ] æ€§èƒ½å„ªåŒ–
- [ ] éƒ¨ç½²æŒ‡å—è£œå……

---

## é™„éŒ„ï¼šä»£ç¢¼ç¯„ä¾‹å’Œå»ºè­°

### A. å»ºè­°çš„ custom hook - useDatepicker

```javascript
// src/hooks/useDatepicker.js
import { useEffect, useRef } from 'react'

export const useDatepicker = onSelect => {
  const inputRef = useRef(null)

  useEffect(() => {
    const $ = window.jQuery
    if ($ && inputRef.current) {
      $(inputRef.current).datepicker({
        dateFormat: 'yy-mm-dd',
        onSelect: dateText => {
          onSelect?.(dateText)
        }
      })
    }

    return () => {
      if ($ && inputRef.current) {
        try {
          if ($(inputRef.current).hasClass('hasDatepicker')) {
            $(inputRef.current).datepicker('destroy')
          }
        } catch (e) {
          console.warn('Datepicker destroy failed', e)
        }
      }
    }
  }, [onSelect])

  return inputRef
}
```

### B. æ”¹é€²çš„ nanoBananaService

```javascript
// src/services/nanoBananaService.js
import axios from 'axios'

export const generateImages = async (prompt, referenceImageUrl) => {
  try {
    // å‘¼å« Firebase Function è€Œéç›´æ¥å‘¼å« API
    const response = await axios.post(
      '/.netlify/functions/generateImages',
      {
        prompt,
        referenceImageUrl
      },
      {
        timeout: 30000 // 30 ç§’è¶…æ™‚
      }
    )

    if (!response.data?.imageUrls) {
      throw new Error('ç„¡æ•ˆçš„ API å›æ‡‰')
    }

    return response.data.imageUrls
  } catch (error) {
    console.error('åœ–ç‰‡ç”Ÿæˆå¤±æ•—:', error)
    throw new Error(`åœ–ç‰‡ç”Ÿæˆå¤±æ•—: ${error.message}`)
  }
}
```

### C. Toast é€šçŸ¥é›†æˆ

```jsx
// src/App.jsx
import { Toaster } from 'react-hot-toast'

function App() {
  return (
    <div className='app'>
      <Toaster
        position='top-right'
        toastOptions={{
          duration: 4000,
          style: {
            background: '#1E1F22',
            color: '#F2F3F5'
          }
        }}
      />
      {/* æ‡‰ç”¨å…¶ä»–å…§å®¹ */}
    </div>
  )
}
```

---

**å¯©æŸ¥å®Œæˆæ—¥æœŸï¼š2025-11-25**  
**å¯©æŸ¥äººå“¡ï¼šAI Code Reviewer**  
**ä¸‹æ¬¡å¯©æŸ¥å»ºè­°æ—¥æœŸï¼š2025-12-02**
